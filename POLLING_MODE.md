# –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Polling —Ä–µ–∂–∏–º

## –ò–∑–º–µ–Ω–µ–Ω–∏—è

–ë–æ—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω –Ω–∞ **polling —Ä–µ–∂–∏–º** –≤–º–µ—Å—Ç–æ webhook —Ä–µ–∂–∏–º–∞. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

- ‚úÖ –ë–æ—Ç —Å–∞–º –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —É Telegram API
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram webhook
- ‚úÖ –ü—Ä–æ—â–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –æ—Ç–ª–∞–¥–∫–µ
- ‚úÖ Webhook —Å–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è YooKassa –ø–ª–∞—Ç–µ–∂–µ–π –∏ Admin API

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### 1. main.py
- –£–±—Ä–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ webhook —Ä–µ–∂–∏–º–∞
- –ë–æ—Ç –≤—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ polling —Ä–µ–∂–∏–º–µ
- Webhook —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ —Ç–æ–ª—å–∫–æ –¥–ª—è YooKassa –∏ Admin API

### 2. server.py
- Telegram webhook endpoint –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 410 (Gone)
- –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–µ—Ç—Å—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ YooKassa webhook –∏ Admin API

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `TELEGRAM_WEBHOOK_URL` –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
- `TELEGRAM_WEBHOOK_SECRET` –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:
```bash
TELEGRAM_BOT_TOKEN=your_token
DATABASE_URL=${{Postgres.DATABASE_URL}}
PORT=8080
```

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (–±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã –¥–ª—è Telegram):
```bash
# –≠—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
# TELEGRAM_WEBHOOK_URL=...  # –£–±—Ä–∞—Ç—å
# TELEGRAM_WEBHOOK_SECRET=...  # –£–±—Ä–∞—Ç—å
```

### –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
```bash
REDIS_URL=${{Redis.REDIS_URL}}
OPENAI_API_KEY=your_key
YOOKASSA_SHOP_ID=your_shop_id
YOOKASSA_SECRET_KEY=your_secret_key
ADMIN_SECRET_KEY=your_admin_secret
ENVIRONMENT=production
LOG_LEVEL=INFO
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Polling —Ä–µ–∂–∏–º–∞

1. **–ü—Ä–æ—â–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** - –Ω–µ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å webhook URL
2. **–ü—Ä–æ—â–µ –æ—Ç–ª–∞–¥–∫–∞** - –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ –±–µ–∑ –ø—É–±–ª–∏—á–Ω–æ–≥–æ URL
3. **–ú–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - –Ω–µ –Ω—É–∂–µ–Ω –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ–º–µ–Ω –¥–ª—è Telegram
4. **–°—Ç–∞–±–∏–ª—å–Ω–µ–µ** - –Ω–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å webhook –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é

## –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ Polling —Ä–µ–∂–∏–º–∞

1. **–ë–æ–ª—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤** - –±–æ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç Telegram API
2. **–ù–µ–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –∑–∞–¥–µ—Ä–∂–∫–∞** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
3. **–ë–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞** - –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

1. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `üîÑ Starting bot in polling mode...`
2. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `‚úÖ Bot is ready, starting polling...`
3. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `üöÄ Starting webhook server on port 8080...`

## Health Check

Health endpoint –æ—Å—Ç–∞–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º:
```bash
curl https://pulse-production-aac1.up.railway.app/health
```

## YooKassa Webhook

YooKassa webhook –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å:
```
POST https://pulse-production-aac1.up.railway.app/webhook/yookassa
```

## Admin API

Admin API –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å:
```
GET https://pulse-production-aac1.up.railway.app/admin/...
```

## –û—Ç–∫–∞—Ç –Ω–∞ Webhook (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ webhook —Ä–µ–∂–∏–º:
1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é –∫–æ–¥–∞ –∏–∑ git
2. –ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞—Ç–Ω–æ –ª–æ–≥–∏–∫—É webhook –≤ main.py
